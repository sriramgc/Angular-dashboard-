<div class="dashboard">
  <div class="dashboard-header">
    <h1 class="dashboard-title">Your Personalized Dashboard</h1>
    <div class="dashboard-controls">
      <button class="btn btn-outline btn-sm flex items-center gap-2" (click)="dashboardService.toggleEditMode()">
        <ng-container *ngIf="editMode">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-save">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/>
          </svg>
          Save Layout
        </ng-container>
        <ng-container *ngIf="!editMode">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/>
          </svg>
          Edit Layout
        </ng-container>
      </button>

      <button *ngIf="editMode" class="btn btn-primary btn-sm flex items-center gap-2" (click)="dashboardService.addCard()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        Add Card
      </button>
      
      <button *ngIf="editMode" class="btn btn-secondary btn-sm flex items-center gap-2" (click)="dashboardService.resetToDefaultCards()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw">
          <path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
          <path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
        </svg>
        Reset Layout
      </button>
    </div>
  </div>

  <div class="gridster-container" [ngClass]="editMode ? 'edit-mode' : ''">
    <gridster [options]="options" class="dashboard-grid">
      <gridster-item [item]="card" *ngFor="let card of cards" (itemChange)="onItemChange(card)" class="grid-item">
        <div class="grid-item-content">
          <app-dashboard-card
            [title]="card.title"
            [content]="card.content"
            [color]="card.color"
            [isEditing]="editMode"
            [size]="card.cols"
            [cardType]="card.cardType || 'default'"
            (remove)="removeItem(card)">
          </app-dashboard-card>
        </div>
      </gridster-item>
    </gridster>
  </div>

  <!-- Instructions for edit mode -->
  <div *ngIf="editMode" class="card mt-4">
    <div class="card-header">
      <h3 class="card-title text-lg">Dashboard Edit Mode</h3>
    </div>
    <div class="card-content">
      <ul class="list-disc pl-5 space-y-1 text-sm">
        <li>Drag cards to reposition them on the grid</li>
        <li>Resize cards by dragging their borders</li>
        <li>Click "Save Layout" when you're done</li>
        <li>Click "Add Card" to add a new card to the dashboard</li>
        <li>Click "Reset Layout" to restore the default layout</li>
      </ul>
    </div>
  </div>
</div>
